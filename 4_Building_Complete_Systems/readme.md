
# 4\_Building\_Complete\_Systems

## 4단계: UAVNAS 시스템의 구현 및 성능 평가

### 목표

RF 기반 UAV 식별 프레임워크인 UAVNAS의 실제 구현을 CNN기반으로 해볼 것이다.

이번 실습에서는 다음을 수행합니다:
1. NAS 기반의 초경량 CNN 구조를 설계한 소프트웨어 측면 구현
2. FPGA 상에서 반복 가능한 Cell 단위로 배치한 하드웨어 구현 전략
3. 실시간 성능 평가 및 기존 모델과의 비교 실험 결과

---

## 4.1 소프트웨어 구현: NAS 기반 경량 CNN 구조

### 4.1.1 설계 목표

* 초단기 입력(2ms IQ 스트림)만으로 높은 식별 정확도 확보
* 수작업 없이 자동화된 아키텍처 탐색
* FPGA 배치 가능성을 고려한 연산 선택

### 4.1.2 탐색 구조

* DARTS 기반 1D convolutional NAS 구조 사용
* 연산 후보: `sep_conv_3x3`, `sep_conv_5x5`, `dil_conv_3x3`, `max_pool_3x3`, `skip_connect`
* Cell 단위 DAG 구성, normal/reduce 셀 구성

### 4.1.3 입력 구조 및 처리

* 복소수 IQ 입력을 I/Q 분리 후 2채널 1D 텐서로 구성
* 2ms 간격으로 3,072 샘플 슬라이싱 (sliding window)
* 빈 세그먼트 제거 전처리 적용 → 오탐 방지 및 연산 효율 개선

### 4.1.4 탐색 결과

* 총 파라미터 수: 11,009개
* 모델 크기: 약 67KB
* 추론 연산량: 약 4.5MFLOP
* NAS 구조 시각화 및 genotype 명시 (ONNX 파일 포함)

---

## 4.2 하드웨어 구현: FPGA 기반 반복 구조 배치

### 4.2.1 구현 환경

* 플랫폼: Xilinx Alveo U250 (Vitis HLS 2022.1)
* 연산 형태: 부동소수점 기반
* 전처리/슬라이싱: 소프트코어 CPU 또는 호스트 측 처리

### 4.2.2 반복 구조 기반 Cell 분할

* 탐색된 네트워크 → `cell0`, `cell1`, `fc` 세 부분으로 분할
* 각 Cell을 독립 HLS 모듈로 구현하여 xclbin으로 컴파일
* 장점:

  * 구조 재사용에 따른 synthesis 효율성 향상
  * 저사양 FPGA 대응을 위한 유연한 구성
  * 유지보수 및 기능 확장 용이

### 4.2.3 리소스 사용 및 최적화

* 전체 리소스 사용량: LUT 기준 40% 이하 (추후 BRAM 대신 LUT로 대체 전략 예정)
* 성능 기준:

  * 모델 적재: BRAM 내 적재 가능
  * 추론 속도: 평균 0.2s 이내 (1 inference)
  * 실시간 조건 만족: 2ms 단위 IQ 입력 처리 가능

---

## 4.3 성능 평가

### 4.3.1 실험 환경

* 데이터셋: DroneDetect\_V2 (13-class, 7종 UAV + 간섭)
* 비교 모델: Baseline CNN, LSTM 기반 모델
* 플랫폼: 학습(RTX 4080), 추론(FPGA U250)

### 4.3.2 정확도 결과

| 모델     | 정확도(%)   | 최소 클래스 정확도 | 오탐률(%)  |
| ------ | -------- | ---------- | ------- |
| UAVNAS | **83.4** | 76.2       | **3.5** |
| CNN    | 78.1     | 65.4       | 7.2     |
| LSTM   | 79.3     | 68.7       | 6.1     |

### 4.3.3 추론 속도 및 리소스 비교

| 모델     | 추론 시간    | 모델 크기    | 파라미터 수     |
| ------ | -------- | -------- | ---------- |
| UAVNAS | **0.2s** | **67KB** | **11,009** |
| CNN    | 0.9s     | 312KB    | 61,213     |
| LSTM   | 2.1s     | 412KB    | 223,000+   |

### 4.3.4 오탐 방지 기법 효과

* 빈 패킷 제거로 평균 38.7% 연산 횟수 감소
* 오탐률: 3.5% → 2.1% 개선

---

## 4.4 요약

* 본 장에서는 NAS 기반 초경량 모델 UAVNAS를 설계 및 FPGA에 배치
* 반복 가능한 Cell 구조로 다양한 엣지 플랫폼에 대응
* 실시간 식별 가능성과 고정확도 동시 확보
* 추후: LUT 기반 리소스 최적화, 저사양 보드(KV260 등) 대응 코드 리팩토링 예정
